# .github/workflows/issue-from-file.yml

# Robust version â†’ works on first run, shallow clones, and exact folder matches

name: Issue from file

on:
push:
branches: \[main]
paths:
\- "issues/*.md"      # topâ€‘level markdown specs
\- "issues/\*\*/*.md"   # or deeper subâ€‘folders if you add them later
workflow\_dispatch:        # manual trigger from the UI

jobs:
create\_issue:
runs-on: ubuntu-latest

```
permissions:
  contents: read   # checkout
  issues: write    # open / edit Issues via API

steps:
  # 1Â â€” Checkout full history so diff detection never errors out
  - name: Checkout repo
    uses: actions/checkout@v4
    with:
      fetch-depth: 0

  # 2Â â€” Detect which markdown files under `issues/` changed in *this push*
  - name: Detect changed markdown files
    id: changed
    uses: tj-actions/changed-files@v44
    with:
      files: |
        issues/*.md
        issues/**/*.md

  # 3Â â€” Shortâ€‘circuit if nothing matched (keeps run green)
  - name: Abort if no markdown files changed
    if: steps.changed.outputs.any_changed != 'true'
    run: echo "ğŸŸ¡ No .md files under 'issues/' were added/modified in this push â€” skipping Issue creation."

  # 4Â â€” Create Issue(s) from every added / modified markdown file
  - name: Create Issue(s)
    if: steps.changed.outputs.any_changed == 'true'
    id: create_issue
    uses: peter-evans/create-issue-from-file@v5
    with:
      title: ${{ github.event.head_commit.message }}
      content-filepath: ${{ steps.changed.outputs.added_modified_files }}
      labels: enhancement, auto-generated

  # 5Â â€” OPTIONAL: Add each created Issue to a Project board
  #       Comment out / delete if youâ€™re not using Projects.
  - name: Add Issue(s) to project board
    if: steps.create_issue.outputs.issue-number != ''
    uses: peter-evans/create-or-update-project-card@v2
    with:
      project-url: https://github.com/orgs/YOUR_ORG/projects/1   # â† change me
      content-id: ${{ steps.create_issue.outputs.issue-number }}
      content-type: Issue
      status: Backlog

  # 6Â â€” Debugâ€‘print which paths we processed (visible in log)
  - name: DebugÂ â€“ list processed files
    if: steps.changed.outputs.any_changed == 'true'
    run: |
      echo "ğŸŸ¢ Markdown files sent to create-issue-from-file:" && \
      printf '%s\n' "${{ steps.changed.outputs.added_modified_files }}"
```
